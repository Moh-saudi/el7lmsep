# ุฅุตูุงุญุงุช Firebase ุงูุชุณุฌูู

## ุงููุดุงูู ุงูุชู ุชู ุญููุง

### 1. ุฎุทุฃ 400 (Bad Request) ูู Firebase
**ุงููุดููุฉ**: ูุงู Firebase ูุฑูุถ ุทูุจุงุช ุงูุชุณุฌูู ุจุณุจุจ ุจุฑูุฏ ุฅููุชุฑููู ุบูุฑ ุตุงูุญ.

**ุงูุญููู ุงููุทุจูุฉ**:

#### ุฃ. ุชุญุณูู ุฅูุดุงุก ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
```typescript
// ูุจู ุงูุฅุตูุงุญ
firebaseEmail = `user_${formData.countryCode}${cleanPhone}@el7lm.local`;

// ุจุนุฏ ุงูุฅุตูุงุญ
const cleanCountryCode = (formData.countryCode || '').replace(/[^0-9]/g, '');
firebaseEmail = `user_${cleanCountryCode}_${cleanPhone}@el7lm.local`;
```

#### ุจ. ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช
```typescript
// ุงูุชุฃูุฏ ูู ูุฌูุฏ ุงูุจูุงูุงุช ุงููุทููุจุฉ
if (!cleanPhone || !cleanCountryCode) {
  throw new Error('ุจูุงูุงุช ุฑูู ุงููุงุชู ุบูุฑ ููุชููุฉ');
}

// ุงูุชุญูู ูู ุตุญุฉ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
if (!isValidEmail(firebaseEmail)) {
  throw new Error('ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุงููููุดุฃ ุบูุฑ ุตุงูุญ');
}

// ุงูุชุฃูุฏ ูู ุงุฎุชูุงุฑ ููุน ุงูุญุณุงุจ
if (!formData.accountType) {
  throw new Error('ูุฑุฌู ุงุฎุชูุงุฑ ููุน ุงูุญุณุงุจ');
}
```

#### ุฌ. ุชุญุณูู ุงูุชุญูู ูู Firebase Auth Provider
```typescript
// ุงูุชุญูู ูู ุตุญุฉ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุจู ุงูุฅุฑุณุงู
const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
if (!emailRegex.test(email)) {
  throw new Error('Invalid email format');
}

// ุงูุชุญูู ูู ุทูู ูููุฉ ุงููุฑูุฑ
if (password.length < 8) {
  throw new Error('Password must be at least 8 characters long');
}
```

### 2. ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
**ุงููุดููุฉ**: ูุงูุช ุฑุณุงุฆู ุงูุฎุทุฃ ุบูุฑ ูุงุถุญุฉ ูููุณุชุฎุฏู.

**ุงูุญููู ุงููุทุจูุฉ**:

#### ุฃ. ุฑุณุงุฆู ุฎุทุฃ ูุญุฏุฏุฉ
```typescript
if (error.message.includes('Invalid email format')) {
  setError('ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุงููููุดุฃ ุบูุฑ ุตุงูุญ. ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู ุฃู ุงูุชูุงุตู ูุน ุงูุฏุนู ุงูููู.');
} else if (error.message.includes('ุจูุงูุงุช ุฑูู ุงููุงุชู ุบูุฑ ููุชููุฉ')) {
  setError('ุจูุงูุงุช ุฑูู ุงููุงุชู ุบูุฑ ููุชููุฉ. ูุฑุฌู ุงูุชุฃูุฏ ูู ุงุฎุชูุงุฑ ุงูุฏููุฉ ูุฅุฏุฎุงู ุฑูู ุงููุงุชู ุงูุตุญูุญ.');
} else if (error.message.includes('auth/weak-password')) {
  setError('ูููุฉ ุงููุฑูุฑ ุถุนููุฉ ุฌุฏุงู. ูุฌุจ ุฃู ุชููู 8 ุฃุญุฑู ุนูู ุงูุฃูู.');
} else if (error.message.includes('auth/invalid-email')) {
  setError('ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุบูุฑ ุตุงูุญ. ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู.');
} else if (error.message.includes('ุจูุงูุงุช ุงูุชุณุฌูู ุบูุฑ ูุชููุฑุฉ')) {
  setError('ุจูุงูุงุช ุงูุชุณุฌูู ุบูุฑ ูุชููุฑุฉ. ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู ูู ุงูุจุฏุงูุฉ.');
} else if (error.message.includes('ูุฑุฌู ุงุฎุชูุงุฑ ููุน ุงูุญุณุงุจ')) {
  setError('ูุฑุฌู ุงุฎุชูุงุฑ ููุน ุงูุญุณุงุจ ูุจู ุงููุชุงุจุนุฉ.');
}
```

### 3. ุชุญุณูู ุชุชุจุน ุงูุฃุฎุทุงุก
**ุงููุดููุฉ**: ูุงู ูู ุงูุตุนุจ ุชุดุฎูุต ุงูุฃุฎุทุงุก.

**ุงูุญููู ุงููุทุจูุฉ**:

#### ุฃ. ุณุฌูุงุช ุชูุตูููุฉ
```typescript
console.log('๐ง Using Firebase email:', firebaseEmail);
console.log('๐ฑ Phone data:', { 
  originalPhone: formData.phone, 
  cleanPhone, 
  countryCode: formData.countryCode, 
  cleanCountryCode,
  verifiedPhone 
});
console.log('Trying to register with:', { 
  email: firebaseEmail, 
  password: formData.password, 
  accountType: formData.accountType, 
  extra: { 
    ...pendingRegistrationData, 
    phone: verifiedPhone, 
    originalEmail: formData.phone.trim() || null, 
    firebaseEmail 
  } 
});
```

#### ุจ. ุทุจุงุนุฉ ุฃุฎุทุงุก Firebase ุงูุชูุตูููุฉ
```typescript
if ((error as any).code) {
  console.error('Firebase error code:', (error as any).code);
}
if ((error as any).message) {
  console.error('Firebase error message:', (error as any).message);
}
```

## ุงูุชุญุณููุงุช ุงูุฅุถุงููุฉ

### 1. ุงูุชุญูู ูู ุงูุจูุงูุงุช ุงููุนููุฉ
```typescript
// ุงูุชุฃูุฏ ูู ูุฌูุฏ ุจูุงูุงุช ุงูุชุณุฌูู ุงููุนููุฉ
if (!pendingRegistrationData) {
  throw new Error('ุจูุงูุงุช ุงูุชุณุฌูู ุบูุฑ ูุชููุฑุฉ. ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู.');
}
```

### 2. ุชูุธูู ุฑููุฒ ุงูุฏูู
```typescript
const cleanCountryCode = (formData.countryCode || '').replace(/[^0-9]/g, '');
```

### 3. ุชุญุณูู ุชูุณูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
```typescript
// ุงุณุชุฎุฏุงู ูุงุตู (_) ุจูู ุฑูุฒ ุงูุฏููุฉ ูุฑูู ุงููุงุชู
firebaseEmail = `user_${cleanCountryCode}_${cleanPhone}@el7lm.local`;
```

## ููููุฉ ุงูุงุฎุชุจุงุฑ

### 1. ุงุฎุชุจุงุฑ ุงูุชุณุฌูู ุงูุนุงุฏู
1. ุงูุชุญ ุตูุญุฉ ุงูุชุณุฌูู
2. ุงุฎุชุฑ ููุน ุงูุญุณุงุจ
3. ุฃุฏุฎู ุงูุงุณู ุงููุงูู
4. ุงุฎุชุฑ ุงูุฏููุฉ
5. ุฃุฏุฎู ุฑูู ุงููุงุชู
6. ุฃุฏุฎู ูููุฉ ุงููุฑูุฑ
7. ุชุฃูุฏ ูู ุฃู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุงููููุดุฃ ุตุงูุญ

### 2. ุงุฎุชุจุงุฑ ุงูุฃุฎุทุงุก
1. ุฌุฑุจ ุงูุชุณุฌูู ุจุฏูู ุงุฎุชูุงุฑ ููุน ุงูุญุณุงุจ
2. ุฌุฑุจ ุงูุชุณุฌูู ุจุฏูู ุงุฎุชูุงุฑ ุงูุฏููุฉ
3. ุฌุฑุจ ุงูุชุณุฌูู ุจุฑูู ูุงุชู ูุตูุฑ
4. ุฌุฑุจ ุงูุชุณุฌูู ุจูููุฉ ูุฑูุฑ ุถุนููุฉ

### 3. ุงุฎุชุจุงุฑ ุณุฌูุงุช ุงูุฃุฎุทุงุก
1. ุงูุชุญ Developer Tools
2. ุงูุชูู ุฅูู Console
3. ุฑุงูุจ ุงูุณุฌูุงุช ุนูุฏ ุงูุชุณุฌูู
4. ุชุฃูุฏ ูู ุธููุฑ ุงูุจูุงูุงุช ุงูุชูุตูููุฉ

## ููุงุญุธุงุช ูููุฉ

1. **ุชูุณูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู**: ุงูุขู ูุณุชุฎุฏู `user_966_123456789@el7lm.local` ุจุฏูุงู ูู `user_+966123456789@el7lm.local`

2. **ุชูุธูู ุงูุจูุงูุงุช**: ูุชู ุชูุธูู ุฑููุฒ ุงูุฏูู ูู ุงูุฃุญุฑู ุบูุฑ ุงูุฑูููุฉ

3. **ุงูุชุญูู ุงููุฒุฏูุฌ**: ูุชู ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช ูู ููุง ูู Frontend ู Backend

4. **ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ**: ูู ุฎุทุฃ ูู ุฑุณุงูุฉ ูุญุฏุฏุฉ ููููุฏุฉ ูููุณุชุฎุฏู

5. **ุณุฌูุงุช ุชูุตูููุฉ**: ูุชู ุชุณุฌูู ุฌููุน ุงูุจูุงูุงุช ุงููููุฉ ููุชุดุฎูุต

## ุงููููุงุช ุงููุญุฏุซุฉ

1. `src/app/auth/register/page.tsx` - ุชุญุณูู ุฅูุดุงุก ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ููุนุงูุฌุฉ ุงูุฃุฎุทุงุก
2. `src/lib/firebase/auth-provider.tsx` - ุชุญุณูู ุงูุชุญูู ูู ุงูุจูุงูุงุช ูุจู ุงูุฅุฑุณุงู ุฅูู Firebase 
