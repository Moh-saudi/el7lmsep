<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¥ØµÙ„Ø§Ø­ ØµÙˆØ± Supabase - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ©</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 600px;
            margin: 0 auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-align: center;
        }
        h1 { color: #1e3a8a; margin-bottom: 20px; }
        .status {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            background: #f8f9fa;
            border-left: 4px solid #3b82f6;
        }
        .success { background: #dcfce7; border-color: #16a34a; color: #166534; }
        .error { background: #fef2f2; border-color: #dc2626; color: #7f1d1d; }
        .warning { background: #fefce8; border-color: #ca8a04; color: #854d0e; }
        button {
            background: linear-gradient(45deg, #3b82f6, #1e40af);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
        }
        button:disabled { opacity: 0.6; cursor: not-allowed; }
        .console {
            background: #1e293b;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            height: 200px;
            overflow-y: auto;
            margin-top: 15px;
            text-align: right;
            font-size: 13px;
        }
        .direct-fix {
            background: #fef3c7;
            border: 2px solid #f59e0b;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        .direct-fix h3 {
            color: #92400e;
            margin-top: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ Ø¥ØµÙ„Ø§Ø­ ØµÙˆØ± Supabase</h1>
        
        <div class="direct-fix">
            <h3>âš¡ Ø§Ù„Ø­Ù„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± - Ø§Ø³ØªØ®Ø¯Ù… Developer Console</h3>
            <p>Ø¨Ø³Ø¨Ø¨ Ù…Ø´ÙƒÙ„Ø© ÙÙŠ ØªØ­Ù…ÙŠÙ„ SupabaseØŒ Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ø§ Ø§Ù„Ø­Ù„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±:</p>
            <ol style="text-align: right;">
                <li>Ø§Ø¶ØºØ· <strong>F12</strong> Ù„ÙØªØ­ Developer Tools</li>
                <li>Ø§Ø°Ù‡Ø¨ Ù„ØªØ¨ÙˆÙŠØ¨ <strong>Console</strong></li>
                <li>Ø§Ù„ØµÙ‚ Ø§Ù„ÙƒÙˆØ¯ Ø£Ø¯Ù†Ø§Ù‡ ÙˆØ§Ø¶ØºØ· Enter</li>
            </ol>
        </div>
        
        <div id="status" class="status">
            âš ï¸ Ø§Ø³ØªØ®Ø¯Ù… Console Ù„Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±
        </div>
        
        <div>
            <button onclick="copyToClipboard()">ğŸ“‹ Ù†Ø³Ø® ÙƒÙˆØ¯ Ø§Ù„Ø¥ØµÙ„Ø§Ø­</button>
            <button onclick="openConsoleInstructions()">ğŸ“– Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ù…ÙØµÙ„Ø©</button>
        </div>
        
        <div id="console" class="console">
Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± ÙƒÙˆØ¯ Ø§Ù„Ø¥ØµÙ„Ø§Ø­...

ğŸ”§ ÙƒÙˆØ¯ Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ù„Ù„Ù€ Console:

fetch('/api/fix-images', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ action: 'fix_broken_images' })
})
.then(response => response.json())
.then(data => {
  console.log('ğŸ“Š Ø§Ù„Ù†ØªØ§Ø¦Ø¬:', data);
  if (data.success) {
    console.log(`ğŸ‰ ØªÙ… Ø¥ØµÙ„Ø§Ø­ ${data.fixed || 0} ØµÙˆØ±Ø©!`);
    if (data.fixed > 0) {
      console.log('ğŸ’¡ Ø£Ø¹Ø¯ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®Ø§Ø¯Ù…: npm run dev');
      setTimeout(() => location.reload(), 3000);
    }
  }
})
.catch(error => console.error('âŒ Ø®Ø·Ø£:', error));

---

Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¨Ø¯ÙŠÙ„:

// Ø¥ØµÙ„Ø§Ø­ Ù…Ø¨Ø§Ø´Ø± Ù„Ù„ØµÙˆØ± Ø§Ù„Ù…ÙƒØ³ÙˆØ±Ø©
(async function directFix() {
  console.log('ğŸš€ Ø¨Ø¯Ø¡ Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±...');
  
  try {
    // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù€ Supabase Ø§Ù„Ù…Ø­Ù„ÙŠ
    if (window.supabase || window.__SUPABASE_CLIENT__) {
      const client = window.supabase || window.__SUPABASE_CLIENT__;
      
      const { data: players, error } = await client
        .from('players')
        .select('id, full_name, profile_image_url, profile_image, avatar_url');
      
      if (error) throw error;
      
      console.log(`ğŸ“Š ÙØ­Øµ ${players.length} Ù„Ø§Ø¹Ø¨`);
      
      let fixed = 0;
      for (const player of players) {
        const updates = {};
        let needsUpdate = false;
        
        const isBad = (url) => !url || 
          url.includes('test-url.com') || 
          url.includes('undefined') || 
          url.includes('null') ||
          url.includes('[object Object]');
        
        if (isBad(player.profile_image_url)) {
          updates.profile_image_url = '/images/default-avatar.png';
          needsUpdate = true;
        }
        if (isBad(player.profile_image)) {
          updates.profile_image = '/images/default-avatar.png';
          needsUpdate = true;
        }
        if (isBad(player.avatar_url)) {
          updates.avatar_url = '/images/default-avatar.png';
          needsUpdate = true;
        }
        
        if (needsUpdate) {
          await client.from('players').update(updates).eq('id', player.id);
          fixed++;
          console.log(`âœ… ${player.full_name || player.id}`);
        }
      }
      
      console.log(`ğŸ‰ ØªÙ… Ø¥ØµÙ„Ø§Ø­ ${fixed} ØµÙˆØ±Ø©!`);
      if (fixed > 0) {
        console.log('ğŸ’¡ Ø£Ø¹Ø¯ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®Ø§Ø¯Ù…: npm run dev');
        setTimeout(() => location.reload(), 3000);
      }
      
    } else {
      console.log('âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Supabase client');
      console.log('ğŸ’¡ ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†Ùƒ ÙÙŠ ØµÙØ­Ø© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Supabase');
    }
    
  } catch (error) {
    console.error('âŒ Ø®Ø·Ø£:', error);
  }
})();
        </div>
    </div>

    <script>
        function copyToClipboard() {
            const code = `// Ø¥ØµÙ„Ø§Ø­ Ù…Ø¨Ø§Ø´Ø± Ù„Ù„ØµÙˆØ± Ø§Ù„Ù…ÙƒØ³ÙˆØ±Ø©
(async function directFix() {
    console.log('ğŸš€ Ø¨Ø¯Ø¡ Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±...');
    
    try {
        // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù… fetch API Ù„Ù„Ø¥ØµÙ„Ø§Ø­
        const response = await fetch('/api/fix-images', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ 
                action: 'fix_broken_images',
                patterns: ['test-url.com', 'undefined', 'null', '[object Object]']
            })
        });
        
        if (response.ok) {
            const data = await response.json();
            console.log('ğŸ“Š Ø§Ù„Ù†ØªØ§Ø¦Ø¬:', data);
            
            if (data.success) {
                console.log(\`ğŸ‰ ØªÙ… Ø¥ØµÙ„Ø§Ø­ \${data.fixed || 0} ØµÙˆØ±Ø©!\`);
                if (data.fixed > 0) {
                    console.log('ğŸ’¡ Ø£Ø¹Ø¯ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®Ø§Ø¯Ù…: npm run dev');
                    setTimeout(() => location.reload(), 3000);
                }
            }
        } else {
            throw new Error('ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ API');
        }
        
    } catch (error) {
        console.error('âŒ Ø®Ø·Ø£:', error);
        console.log('ğŸ’¡ ØªØ£ÙƒØ¯ Ù…Ù† ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®Ø§Ø¯Ù… ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©');
    }
})();`;

            navigator.clipboard.writeText(code).then(() => {
                alert('âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯! Ø§Ù„ØµÙ‚Ù‡ ÙÙŠ Console ÙˆØ§Ø¶ØºØ· Enter');
            }).catch(() => {
                // Fallback
                const textArea = document.createElement('textarea');
                textArea.value = code;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯! Ø§Ù„ØµÙ‚Ù‡ ÙÙŠ Console ÙˆØ§Ø¶ØºØ· Enter');
            });
        }
        
        function openConsoleInstructions() {
            const instructions = `
ğŸ”§ Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù…ÙØµÙ„Ø©:

1ï¸âƒ£ ÙØªØ­ Developer Console:
   - Windows/Linux: Ø§Ø¶ØºØ· F12
   - Mac: Cmd + Option + I
   - Ø£Ùˆ: ÙƒÙ„ÙŠÙƒ ÙŠÙ…ÙŠÙ† > Inspect > Console

2ï¸âƒ£ ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯:
   - Ø§Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯ Ù…Ù† Ø§Ù„Ø²Ø± "Ù†Ø³Ø® ÙƒÙˆØ¯ Ø§Ù„Ø¥ØµÙ„Ø§Ø­"
   - Ø§Ù„ØµÙ‚Ù‡ ÙÙŠ Console
   - Ø§Ø¶ØºØ· Enter

3ï¸âƒ£ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©:
   - Ø³ÙŠØ¸Ù‡Ø± Ø¹Ø¯Ø¯ Ø§Ù„ØµÙˆØ± Ø§Ù„Ù…ÙØµÙ„Ø­Ø©
   - Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¹Ø¯Ø¯ > 0ØŒ Ø£Ø¹Ø¯ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®Ø§Ø¯Ù…
   - Ø³ØªØ®ØªÙÙŠ Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„ØµÙˆØ±

4ï¸âƒ£ Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡:
   - Ø£ØºÙ„Ù‚ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ (Ctrl+C)
   - Ø´ØºÙ„Ù‡ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰: npm run dev
   - ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ø®ØªÙØ§Ø¡ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡

ğŸ’¡ Ù†ØµØ§Ø¦Ø­:
   - ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª
   - Ù„Ø§ ØªØºÙ„Ù‚ Ø§Ù„Ù…ØªØµÙØ­ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
   - Ø¥Ø°Ø§ ÙØ´Ù„ØªØŒ Ø¬Ø±Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
            `;
            
            alert(instructions);
        }
        
        // Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨ÙŠØ©
        console.log('ğŸ”§ ØµÙØ­Ø© Ø¥ØµÙ„Ø§Ø­ ØµÙˆØ± Supabase - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ©');
        console.log('ğŸ’¡ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø£Ø¹Ù„Ø§Ù‡ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙƒÙˆØ¯ Ø§Ù„Ø¥ØµÙ„Ø§Ø­');
    </script>
</body>
</html> 