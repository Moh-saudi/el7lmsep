# دليل نظام صلاحيات الموظفين

## 🎯 نظرة عامة

تم إنشاء نظام صلاحيات متقدم للموظفين يضمن حماية البيانات وتوزيع الصلاحيات بشكل آمن ومنظم.

## 👥 أنواع الموظفين

### **1. موظف خدمة العملاء** (`customer_service`)
- **الوصف**: موظف متخصص في التواصل مع العملاء
- **الصلاحيات**: محدودة للتواصل فقط
- **الأدوات المتاحة**: واتساب، مكالمات، بريد إلكتروني

### **2. موظف إدخال البيانات** (`data_entry`)
- **الوصف**: موظف متخصص في رفع وإدخال البيانات
- **الصلاحيات**: محدودة لإدخال البيانات فقط
- **الأدوات المتاحة**: رفع ملفات، إضافة عملاء

### **3. مشرف** (`supervisor`)
- **الوصف**: مشرف على فريق العمل
- **الصلاحيات**: متوسطة مع إمكانية إدارة البيانات
- **الأدوات المتاحة**: جميع أدوات التواصل + أدوات متقدمة محدودة

### **4. مدير** (`manager`)
- **الوصف**: مدير قسم أو فريق
- **الصلاحيات**: عالية مع إمكانية إدارة المستخدمين
- **الأدوات المتاحة**: جميع الأدوات تقريباً

### **5. مدير النظام** (`admin`)
- **الوصف**: مدير النظام الكامل
- **الصلاحيات**: كاملة
- **الأدوات المتاحة**: جميع الأدوات بدون قيود

### **6. مطور** (`developer`)
- **الوصف**: مطور النظام
- **الصلاحيات**: كاملة
- **الأدوات المتاحة**: جميع الأدوات بدون قيود

## 🔐 الصلاحيات المتاحة

### **إدارة العملاء:**
- ✅ **عرض العملاء** (`canViewCustomers`)
- ✅ **تعديل العملاء** (`canEditCustomers`)
- ✅ **حذف العملاء** (`canDeleteCustomers`)
- ✅ **إضافة عملاء** (`canAddCustomers`)

### **رفع الملفات:**
- ✅ **رفع ملفات** (`canUploadFiles`)
- ✅ **تحميل ملفات** (`canDownloadFiles`)

### **التواصل:**
- ✅ **إرسال واتساب** (`canSendWhatsApp`)
- ✅ **إجراء مكالمات** (`canMakeCalls`)
- ✅ **إرسال بريد إلكتروني** (`canSendEmails`)

### **إدارة البيانات:**
- ✅ **عرض الإحصائيات** (`canViewStatistics`)
- ✅ **تصدير البيانات** (`canExportData`)
- ✅ **استيراد البيانات** (`canImportData`)

### **الأدوات المتقدمة:**
- ✅ **الوصول للأدوات المتقدمة** (`canAccessAdvancedTools`)
- ✅ **اختبار تنسيق الأرقام** (`canTestPhoneFormatting`)
- ✅ **إصلاح أرقام الهواتف** (`canFixPhoneNumbers`)
- ✅ **إزالة التكرارات** (`canRemoveDuplicates`)
- ✅ **حذف جميع البيانات** (`canDeleteAllData`)

### **إدارة النظام:**
- ✅ **إدارة المستخدمين** (`canManageUsers`)
- ✅ **إدارة الأدوار** (`canManageRoles`)
- ✅ **عرض السجلات** (`canViewLogs`)
- ✅ **الوصول للوحة الإدارة** (`canAccessAdminPanel`)

## 📊 جدول الصلاحيات

| الصلاحية | خدمة عملاء | إدخال بيانات | مشرف | مدير | مدير النظام | مطور |
|-----------|-------------|--------------|------|------|-------------|------|
| **عرض العملاء** | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| **تعديل العملاء** | ✅ | ❌ | ✅ | ✅ | ✅ | ✅ |
| **حذف العملاء** | ❌ | ❌ | ✅ | ✅ | ✅ | ✅ |
| **إضافة عملاء** | ❌ | ✅ | ✅ | ✅ | ✅ | ✅ |
| **رفع ملفات** | ❌ | ✅ | ✅ | ✅ | ✅ | ✅ |
| **تحميل ملفات** | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| **إرسال واتساب** | ✅ | ❌ | ✅ | ✅ | ✅ | ✅ |
| **إجراء مكالمات** | ✅ | ❌ | ✅ | ✅ | ✅ | ✅ |
| **إرسال بريد إلكتروني** | ✅ | ❌ | ✅ | ✅ | ✅ | ✅ |
| **عرض الإحصائيات** | ✅ | ❌ | ✅ | ✅ | ✅ | ✅ |
| **تصدير البيانات** | ❌ | ❌ | ✅ | ✅ | ✅ | ✅ |
| **استيراد البيانات** | ❌ | ✅ | ✅ | ✅ | ✅ | ✅ |
| **الأدوات المتقدمة** | ❌ | ❌ | ✅ | ✅ | ✅ | ✅ |
| **اختبار تنسيق الأرقام** | ❌ | ❌ | ✅ | ✅ | ✅ | ✅ |
| **إصلاح أرقام الهواتف** | ❌ | ❌ | ✅ | ✅ | ✅ | ✅ |
| **إزالة التكرارات** | ❌ | ❌ | ❌ | ✅ | ✅ | ✅ |
| **حذف جميع البيانات** | ❌ | ❌ | ❌ | ❌ | ✅ | ✅ |
| **إدارة المستخدمين** | ❌ | ❌ | ❌ | ✅ | ✅ | ✅ |
| **إدارة الأدوار** | ❌ | ❌ | ❌ | ❌ | ✅ | ✅ |
| **عرض السجلات** | ❌ | ❌ | ✅ | ✅ | ✅ | ✅ |
| **الوصول للوحة الإدارة** | ❌ | ❌ | ❌ | ✅ | ✅ | ✅ |

## 🛠️ كيفية الاستخدام

### **1. إضافة نظام الصلاحيات:**
```typescript
import { useEmployeePermissions, PermissionGuard } from '@/hooks/useEmployeePermissions';

export default function CustomerManagementPage() {
  const { permissions, role, loading } = useEmployeePermissions();
  
  // استخدام الصلاحيات
  if (permissions?.canSendWhatsApp) {
    // إظهار زر الواتساب
  }
}
```

### **2. حماية المكونات:**
```typescript
<PermissionGuard 
  requiredPermissions={['canSendWhatsApp']}
  fallback={<div>غير مصرح لك بإرسال واتساب</div>}
>
  <Button>إرسال واتساب</Button>
</PermissionGuard>
```

### **3. التحقق من الصلاحيات:**
```typescript
const { hasPermission, hasAnyPermission, hasAllPermissions } = useEmployeePermissions();

// التحقق من صلاحية واحدة
if (hasPermission('canSendWhatsApp')) {
  // إظهار زر الواتساب
}

// التحقق من أي صلاحية من مجموعة
if (hasAnyPermission(['canSendWhatsApp', 'canMakeCalls'])) {
  // إظهار أزرار التواصل
}

// التحقق من جميع الصلاحيات
if (hasAllPermissions(['canViewCustomers', 'canEditCustomers'])) {
  // إظهار أدوات الإدارة الكاملة
}
```

## 🎯 أمثلة عملية

### **مثال 1: موظف خدمة العملاء**
```typescript
// الصلاحيات المتاحة:
- canViewCustomers: true
- canEditCustomers: true
- canSendWhatsApp: true
- canMakeCalls: true
- canSendEmails: true

// الأدوات المتاحة:
- عرض العملاء
- تعديل بيانات العملاء
- إرسال واتساب
- إجراء مكالمات
- إرسال بريد إلكتروني
- تسجيل التواصل

// الأدوات المحظورة:
- رفع ملفات
- حذف العملاء
- الأدوات المتقدمة
- إدارة النظام
```

### **مثال 2: موظف إدخال البيانات**
```typescript
// الصلاحيات المتاحة:
- canViewCustomers: true
- canAddCustomers: true
- canUploadFiles: true
- canDownloadFiles: true
- canImportData: true

// الأدوات المتاحة:
- عرض العملاء
- إضافة عملاء جدد
- رفع ملفات CSV/Excel
- تحميل النماذج
- استيراد البيانات

// الأدوات المحظورة:
- التواصل مع العملاء
- تعديل البيانات
- الأدوات المتقدمة
- إدارة النظام
```

### **مثال 3: مشرف**
```typescript
// الصلاحيات المتاحة:
- جميع صلاحيات التواصل
- جميع صلاحيات إدارة العملاء
- الأدوات المتقدمة المحدودة
- عرض السجلات

// الأدوات المتاحة:
- جميع أدوات التواصل
- إدارة العملاء الكاملة
- اختبار تنسيق الأرقام
- إصلاح أرقام الهواتف
- عرض السجلات

// الأدوات المحظورة:
- إزالة التكرارات
- حذف جميع البيانات
- إدارة المستخدمين
- إدارة الأدوار
```

## 🔧 التخصيص والتطوير

### **إضافة دور جديد:**
```typescript
// في ROLE_PERMISSIONS
const newRole: EmployeePermissions = {
  canViewCustomers: true,
  canEditCustomers: false,
  canDeleteCustomers: false,
  canAddCustomers: true,
  // ... باقي الصلاحيات
};

ROLE_PERMISSIONS['new_role'] = newRole;
```

### **إضافة صلاحية جديدة:**
```typescript
// في EmployeePermissions interface
export interface EmployeePermissions {
  // ... الصلاحيات الموجودة
  canNewPermission: boolean;
}

// في ROLE_PERMISSIONS لكل دور
customer_service: {
  // ... الصلاحيات الموجودة
  canNewPermission: false,
},
admin: {
  // ... الصلاحيات الموجودة
  canNewPermission: true,
}
```

## 🚀 المميزات

### **الأمان:**
- ✅ **حماية شاملة**: من الوصول غير المصرح
- ✅ **صلاحيات دقيقة**: لكل دور صلاحيات محددة
- ✅ **حماية البيانات**: من التعديل أو الحذف العرضي
- ✅ **تتبع الصلاحيات**: معرفة من يستخدم ماذا

### **المرونة:**
- ✅ **سهولة التخصيص**: إضافة أدوار وصلاحيات جديدة
- ✅ **توزيع ديناميكي**: تغيير الصلاحيات بسهولة
- ✅ **واجهة ذكية**: إظهار الأدوات حسب الصلاحيات
- ✅ **رسائل واضحة**: عند عدم وجود صلاحية

### **الإدارة:**
- ✅ **إدارة مركزية**: جميع الصلاحيات في مكان واحد
- ✅ **تحديث سهل**: تغيير الصلاحيات بسرعة
- ✅ **توثيق شامل**: لكل دور وصلاحية
- ✅ **اختبار بسيط**: التحقق من الصلاحيات

## 📋 أفضل الممارسات

### **للمطورين:**
- ✅ **استخدم PermissionGuard**: لحماية جميع المكونات
- ✅ **تحقق من الصلاحيات**: قبل تنفيذ أي إجراء
- ✅ **وفر رسائل واضحة**: عند عدم وجود صلاحية
- ✅ **اختبر الصلاحيات**: للتأكد من عملها

### **للمديرين:**
- ✅ **وزع الصلاحيات بحكمة**: حسب الحاجة الفعلية
- ✅ **راجع الصلاحيات دورياً**: للتأكد من ملاءمتها
- ✅ **درّب الموظفين**: على استخدام الأدوات المتاحة
- ✅ **راقب الاستخدام**: للتأكد من الأمان

### **للموظفين:**
- ✅ **استخدم الأدوات المتاحة فقط**: لا تحاول الوصول لما هو محظور
- ✅ **تواصل مع المدير**: إذا احتجت صلاحيات إضافية
- ✅ **احترم قواعد الأمان**: لحماية البيانات
- ✅ **سجل إجراءاتك**: للتتبع والمراجعة

---

**نظام الصلاحيات الجديد يضمن حماية شاملة للبيانات وتوزيع آمن للصلاحيات! 🛡️**







